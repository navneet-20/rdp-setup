name: Ubuntu Runner

on:
  workflow_dispatch:

jobs:
  ssh:
    runs-on: ubuntu-latest
    timeout-minutes: 600

    steps:
      - name: Start tmate (SSH)
        id: tmate
        uses: mxschmitt/action-tmate@v3
        with:
          limit-access-to-actor: false
          detached: true  # Run in background

      - name: Show SSH connection (1 minute)
        run: |
          echo "âš¡ SSH access available for 1 minute â€” copy your link below:"
          echo "SSH: $(tmate show-messages | grep 'ssh ' | head -n 1)"
          echo "Web: $(tmate show-messages | grep 'https://tmate.io/t/' | head -n 1)"
          sleep 60
          echo "ðŸ”’ Hiding connection logs..."
          sudo -u runner tmate kill-session || true

      - name: Keep VPS alive (6 hours)
        run: |
          echo "âœ… SSH session active. Runner will stay alive for 6 hours."
          sleep 21600
