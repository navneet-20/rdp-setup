name: Free SSH VPS (Ubuntu Runner)

on:
  # This triggers the workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  build:
    # Use the latest Ubuntu runner (Linux)
    runs-on: ubuntu-latest
    # Set the timeout for the session (360 minutes = 6 hours)
    timeout-minutes: 360

    steps:
      - name: Set up tmate session for SSH access
        uses: mxschmitt/action-tmate@v3
        with:
          # This action sets up a temporary SSH tunnel and prints the connection details.
          # The tmate session will stay active for the entire duration of the workflow
          # or until you manually close the tmate session.
          limit-access-to-actor: false
          
      # --- SSH Credential Setup (Critical Step) ---
      # Tmate does not natively support setting a password for the SSH tunnel.
      # The connection details (SSH and Web URLs) are printed directly to the logs.
      
      # The article's requirement for a root@123 password cannot be directly met
      # with this secure method (tmate uses temporary keys).
      # The **SSH connection string** printed in the logs is your "credential".
      
      # For your reference, the user inside the runner will be 'runner' (not root).
      
      - name: Print Connection Details Reminder
        run: |
          echo "=================================================================="
          echo "ðŸš¨ IMPORTANT: YOUR SSH CONNECTION DETAILS ARE ABOVE ðŸš¨"
          echo "Look for the output line starting with 'Web Shell:' or 'SSH:'"
          echo " "
          echo "The **SSH connection string** (e.g., ssh <random-string>@<ip-address>) is your key."
          echo "Paste this entire string into your local terminal (e.g., PuTTY/WSL/Terminal)."
          echo " "
          echo "User: **runner**"
          echo "Timeout: **6 hours**"
          echo "=================================================================="
          # Keep the job running for the full timeout-minutes, maintaining the SSH session
          sleep 21600
